import {FC, useEffect, useState} from "react";
import LogoImg from "@/assets/img/logo.png";
import UserIcon from "@/assets/img/user-icon.svg";
import HeaderTopAuth from "./HeaderTopAuth/HeaderTopAuth";
import InputSearch from "../../UI/InputSearch/InputSearch";
import style from "./HeaderTop.module.scss";
import Link from "next/link";
import Image from "next/image";
import {useTheme} from "next-themes";
import {headerTypes} from "@/components/Header/Header";
import HeaderTopLocation from "@/components/Header/HeaderTop/HeaderTopLocation/HeaderTopLocation";
import {useAuth} from "@/hooks/useAuth";


interface HeaderTopProps {
    type?: headerTypes
}

const HeaderTop: FC<HeaderTopProps> = ({type}) => {
    let isRender = false;
    if (type === headerTypes.auth) isRender = true;

    const {user, isLoading} = useAuth();

    const {theme, setTheme} = useTheme();

    const handleLightTheme = () => {
        setTheme('light');
    }

    const handleDarkTheme = () => {
        setTheme('dark');
    }

    const [domLoaded, setDomLoaded] = useState(false);

    useEffect(() => {
        setDomLoaded(true);
    }, [domLoaded]);

    return (
        <div className={style.top}>
            <div className={style.left}>
                <Link href="/" className={style.logo}>
                    <Image
                        src={LogoImg}
                        alt="logo"
                        width={99}
                        height={42}
                    />
                </Link>

                {/*{!isRender*/}
                {/*    && <div className={style.phone}>*/}
                {/*        <span>Бесплатный звонок</span>*/}
                {/*        8 800 080 5011*/}
                {/*    </div>*/}
                {/*}*/}


                {
                    domLoaded && theme === 'light'
                    && <button className={style.dark} onClick={handleDarkTheme}>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1920">
                            <path className={style.st0}
                                  d="M1294.4 1447.1c132.3 0 255.2-40.3 357.1-109.2-129.3 218.6-367.5 365.2-640 365.2-410.4 0-743-332.7-743-743.1s332.7-743 743-743c14.2 0 28.3.4 42.2 1.2-233 95-397.3 323.8-397.3 591 .1 352.2 285.7 637.9 638 637.9z"
                                  id="Layer_5"/>
                            <path className={style.st1}
                                  d="M1294.4 1447.1c-352.3 0-637.9-285.6-637.9-637.9 0-267.2 164.2-496 397.3-591-14-.8-28.1-1.2-42.2-1.2-410.4 0-743 332.7-743 743s332.7 743.1 743 743.1c272.4 0 510.6-146.6 640-365.2-102 68.9-224.9 109.2-357.2 109.2z"
                                  id="STROKES"/>
                        </svg>
                    </button>
                }

                {
                    domLoaded && theme === 'dark'
                    && <div className={style.light} onClick={handleLightTheme}>
                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24px"
                             height="24px"
                             viewBox="0 0 612 612"
                        >
                            <g>
                                <g id="_x37__5_">
                                    <g>
                                        <path d="M76.5,286.875H19.125C8.568,286.875,0,295.443,0,306c0,10.557,8.568,19.125,19.125,19.125H76.5
                                            c10.557,0,19.125-8.568,19.125-19.125C95.625,295.443,87.057,286.875,76.5,286.875z M306,95.625
                                            c10.557,0,19.125-8.568,19.125-19.125V19.125C325.125,8.568,316.557,0,306,0c-10.557,0-19.125,8.568-19.125,19.125V76.5
                                            C286.875,87.057,295.443,95.625,306,95.625z M490.002,148.792l40.182-40.182c7.401-7.401,7.401-19.393,0-26.794
                                            s-19.394-7.401-26.795,0l-40.182,40.182c-7.401,7.401-7.401,19.393,0,26.794C470.609,156.194,482.601,156.194,490.002,148.792z
                                            M141.716,443.509l-40.182,40.182c-7.401,7.401-7.401,19.393,0,26.794s19.393,7.401,26.794,0l40.182-40.182
                                            c7.401-7.401,7.401-19.393,0-26.794S149.118,436.107,141.716,443.509z M130.203,157.246c7.478,7.478,19.584,7.478,27.042,0
                                            c7.459-7.478,7.459-19.584,0-27.042L116.682,89.62c-7.478-7.478-19.584-7.478-27.043,0c-7.478,7.478-7.478,19.584,0,27.043
                                            L130.203,157.246z M306,516.375c-10.557,0-19.125,8.568-19.125,19.125v57.375c0,10.557,8.568,19.125,19.125,19.125
                                            c10.557,0,19.125-8.568,19.125-19.125V535.5C325.125,524.943,316.557,516.375,306,516.375z M481.797,454.754
                                            c-7.478-7.478-19.584-7.478-27.043,0c-7.478,7.479-7.478,19.584,0,27.043l40.564,40.564c7.478,7.478,19.584,7.478,27.043,0
                                            c7.459-7.479,7.478-19.584,0-27.043L481.797,454.754z M592.875,286.875H535.5c-10.557,0-19.125,8.568-19.125,19.125
                                            c0,10.557,8.568,19.125,19.125,19.125h57.375c10.557,0,19.125-8.568,19.125-19.125C612,295.443,603.432,286.875,592.875,286.875z
                                            M306,133.76c-95.128,0-172.24,77.112-172.24,172.24S210.872,478.24,306,478.24S478.24,401.128,478.24,306
                                            S401.128,133.76,306,133.76z M306,439.837c-73.918,0-133.837-59.919-133.837-133.837S232.082,172.163,306,172.163
                                            S439.837,232.082,439.837,306S379.918,439.837,306,439.837z"/>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>
                }
            </div>

            <Link href="/categories">Каталог</Link>

            {!isRender
                && <div className={style.center}>
                    {/*<InputSearch searchTerm="" placeholder="bfbdbfbfd" handleSearch={()}/>*/}
                </div>
            }

            {!isRender
                && <div className={style.right}>
                    <HeaderTopLocation/>

                    <Link href="/">
                        <div className={style.logoMobile}>
                            <svg width="85" height="35" viewBox="0 0 85 35" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path d="M75.5124 17.0355L75.3331 16.3613L74.7168 16.9123L75.5124 17.0355Z"
                                      fill="#00622B"/>
                                <path
                                    d="M67.5529 9.14898L69.4149 12.8878L71.3758 14.5441L75.2192 15.9425L73.6094 9.9304L79.9236 9.73598L80.1178 16.6229L84.9996 14.9367L84.8708 8.50216L77.4024 8.62928L73.5926 9.86123L73.5328 9.64438L72.2853 7.44967L70.7614 7.4721L70.9033 6.73742L71.4935 6.03825L69.5867 6.47944L68.9723 4.93342L67.8611 4.39315L68.1804 3.52387L68.9368 4.33333L69.4261 2.58168L71.6597 2.01898L72.2087 3.11073L74.3079 0.895456L74.3284 0L72.6551 0.0112166L71.204 1.23569L70.2067 0.106557L67.8499 0.508484L66.8078 3.55939L67.9993 6.0476L65.7881 8.85174L67.5529 9.14898Z"
                                    fill="#00622B"/>
                                <path d="M76.7808 17.2313L75.5127 17.0352L75.7424 17.8924L76.7808 17.2313Z"
                                      fill="#00622B"/>
                                <path d="M75.6343 16.0928L75.2197 15.9434L75.3337 16.3617L75.6343 16.0928Z"
                                      fill="#00622B"/>
                                <path
                                    d="M69.7066 17.6924L72.4725 22.2538L73.6864 18.3205L71.7983 17.8662L68.5506 15.8043L65.7549 11.3887L67.5963 16.023L69.7066 17.6924Z"
                                    fill="#00622B"/>
                                <path
                                    d="M77.7243 32.1682L75.3264 32.0728L73.5223 33.0431L73.5186 34.0862L76.8204 33.1758L78.8131 32.9571L80.8991 31.1026L79.8309 30.166L77.7243 32.1682Z"
                                    fill="#00622B"/>
                                <path d="M75.6755 23.7588L77.8773 19.9414H73.4736L75.6755 23.7588Z" fill="#00622B"/>
                                <path
                                    d="M70.7622 28.4741L73.0929 33.0149L76.4414 31.2932L73.3917 25.3522L73.3637 25.3653L70.4074 19.8691L66.1027 19.9009L68.7658 25.2419L63.249 29.7341L63.6823 30.265L64.7449 32.2447L64.6964 33.5832L68.7658 33.5982L69.285 32.1288L67.0981 32.6373L67.1429 31.4203L70.7622 28.4741Z"
                                    fill="#00622B"/>
                                <path
                                    d="M10.3834 27.9936C10.2238 28.3136 10.0242 28.612 9.78952 28.8816C9.54099 29.1832 9.22638 29.4234 8.87011 29.5835C8.51384 29.7437 8.12549 29.8195 7.7352 29.8051C6.48394 29.8051 5.81349 29.1116 5.56884 28.5619C5.39469 28.1714 5.31166 27.7462 5.32606 27.3188C5.32606 25.9522 5.96476 24.7259 6.13284 24.3894C7.15439 22.52 8.46729 22.2414 9.25913 22.2414C9.3357 22.2414 10.6467 22.2414 11.151 23.1107C11.2843 23.3809 11.3521 23.6787 11.3489 23.98C11.351 24.1687 11.3303 24.357 11.2873 24.5408H15.3399C15.3852 24.3066 15.4108 24.069 15.4165 23.8304C15.4111 23.4697 15.3545 23.1115 15.2484 22.7667C15.0272 22.087 14.6265 21.4798 14.0886 21.0095C12.3667 19.4822 9.80446 19.5345 9.31703 19.5345C8.37484 19.5184 7.43612 19.6528 6.53623 19.9327C4.91493 20.4756 3.54794 21.5933 2.6928 23.0752C1.9019 24.3756 1.48027 25.8674 1.47329 27.3898C1.45004 28.178 1.584 28.9628 1.86734 29.6986C2.05888 30.1639 2.33283 30.5907 2.67599 30.9586C3.96461 32.3419 5.99277 32.7158 7.65677 32.7158C10.417 32.7158 11.9876 31.74 12.9177 30.8165C13.8165 29.9095 14.4357 28.7628 14.7012 27.5132H10.5664C10.518 27.6779 10.4568 27.8385 10.3834 27.9936Z"
                                    fill="#00622B"/>
                                <path
                                    d="M26.4985 20.3064C25.1408 19.5418 23.4637 19.5418 23.0678 19.5418C21.8304 19.5236 20.608 19.8144 19.5111 20.3879C18.4142 20.9613 17.4773 21.7994 16.7853 22.8264C15.8852 24.1051 15.2296 25.8175 15.2296 27.4775C15.2094 28.4739 15.4626 29.4568 15.9617 30.3191C17.4091 32.7493 20.231 32.7157 20.8174 32.7157C24.4479 32.7157 26.3696 30.7808 27.3146 29.4143C27.7105 28.8534 28.8385 27.0345 28.8385 24.7089C28.8609 22.7199 28.0224 21.1589 26.4985 20.3064ZM24.0912 27.7262C23.1443 29.5732 21.9248 29.8218 21.1479 29.8218C20.8299 29.8384 20.5127 29.7777 20.2232 29.6449C19.9338 29.5121 19.6808 29.3111 19.4858 29.0591C19.2274 28.6728 19.0968 28.2151 19.1123 27.7505C19.1123 26.6849 19.6296 25.2641 20.1189 24.3855C20.7595 23.2639 21.7045 22.3796 22.9202 22.3796C23.4077 22.3628 24.9746 22.5666 24.9746 24.5818C24.9727 25.9334 24.1958 27.5131 24.0912 27.7262Z"
                                    fill="#00622B"/>
                                <path
                                    d="M51.0463 19.8613L46.1216 28.242L46.0132 19.8613H42.2669H42.2333H38.7447L36.6867 27.4961L35.3439 19.8613H31.4407L27.6738 32.3958H31.2259L33.1626 24.9929L34.5819 32.3958H38.5001L42.237 19.9604L42.8421 32.3958H47.4625L55.605 19.8613H51.0463Z"
                                    fill="#00622B"/>
                                <path
                                    d="M62.1749 27.4063L62.9219 24.7611H58.3483L58.9272 22.7739H64.0817L64.9501 19.8613H55.9074L52.2021 32.3958H61.4746L62.3131 29.5375H56.9458L57.5695 27.4063H62.1749Z"
                                    fill="#00622B"/>
                            </svg>
                        </div>
                    </Link>

                    {
                        isLoading
                            ? <div>loading...</div>
                            : domLoaded && user
                                ? <>
                                    <Link href="/profile">
                                        <div className={style.loginMobile}>
                                            <span>{user?.email}</span>
                                            <img src={UserIcon} alt=""/>
                                        </div>
                                    </Link>
                                    <HeaderTopAuth user={user}/>
                                </>
                                : <>
                                    <Link href="/login">
                                        <div className={style.loginMobile}>
                                            <span>Войти</span>
                                            <img src={UserIcon} alt=""/>
                                        </div>
                                    </Link>
                                    {/*<Link href="/login"><a className={style.login}>Войти</a></Link>*/}
                                </>
                    }
                </div>
            }

            {/*{isRender && <Link href="/"><a className={style.back}>Назад на главную</a></Link>}*/}
        </div>
    );
};

export default HeaderTop;